<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è‹±æ–‡å–®å­—å¡«ç©ºç·´ç¿’å™¨</title>
  <style>
    body { font-family: "Arial", sans-serif; background-color: #f4f4f4; padding: 30px; color: #333; }
    h1 { color: #007BFF; }
    .question { font-size: 1.2em; margin-top: 20px; }
    #feedback, #logDisplay { margin-top: 10px; font-weight: bold; white-space: pre-wrap; }
    input { padding: 5px; font-size: 1em; }
    button { padding: 6px 12px; font-size: 1em; margin: 5px 10px 10px 0; }
    #logDisplay {
      display: none;
      border: 1px solid #ccc;
      padding: 10px;
      background-color: #fff;
    }
  </style>
</head>
<body>

<h1>ğŸ“˜ è‹±æ–‡å–®å­—å¡«ç©ºç·´ç¿’å™¨</h1>

<div class="question" id="question"></div>
<input type="text" id="answerInput" placeholder="è«‹è¼¸å…¥å®Œæ•´å–®å­—">
<br>
<button onclick="checkAnswer()">æäº¤ç­”æ¡ˆ</button>
<button onclick="restart()">é‡æ–°æŒ‘æˆ°</button>
<button onclick="toggleLog('last')">åˆ‡æ›é¡¯ç¤ºæœ€è¿‘ä¸€æ¬¡ç´€éŒ„</button>
<button onclick="toggleLog('all')">åˆ‡æ›é¡¯ç¤ºæ‰€æœ‰ç´€éŒ„</button>

<div id="feedback"></div>
<div id="score"></div>

<hr>
<h3>ğŸ“‚ æ­·å²ç´€éŒ„</h3>
<div id="logDisplay"></div>

<script>
const questions = [
  { hint: "å‹•ç‰©", word: "animal" },
  { hint: "æ›¸", word: "book" },
  { hint: "å­¸æ ¡", word: "school" },
  { hint: "è˜‹æœ", word: "apple" },
  { hint: "æœ‹å‹", word: "friend" },
  { hint: "å®¶åº­", word: "family" },
  { hint: "è·‘", word: "run" },
  { hint: "è½", word: "listen" },
  { hint: "ç¬‘", word: "laugh" },
  { hint: "å­¸ç¿’", word: "learn" }
];

let currentIndex = 0;
let score = 0;
let shuffled = [];
let currentLog = [];
let allLogs = [];

function generatePuzzle(word) {
  return word.length <= 3
    ? word[0] + "_".repeat(word.length - 1)
    : word[0] + "_".repeat(word.length - 2) + word[word.length - 1];
}

function displayQuestion() {
  if (currentIndex < shuffled.length) {
    const q = shuffled[currentIndex];
    document.getElementById("question").innerText =
      `${currentIndex + 1}. æç¤ºï¼š${q.hint} â†’ ${generatePuzzle(q.word)}`;
    document.getElementById("answerInput").value = "";
    document.getElementById("feedback").innerText = "";
  } else {
    const rate = ((score / shuffled.length) * 100).toFixed(1);
    const summary = `ğŸ‰ ç·´ç¿’å®Œæˆï¼ä½ ç­”å°äº† ${score} / ${shuffled.length} é¡Œï¼Œæ­£ç¢ºç‡ï¼š${rate}%`;
    document.getElementById("question").innerText = summary;
    document.getElementById("feedback").innerText = "";
    document.getElementById("score").innerText = "";
    currentLog.push(summary);
    allLogs.push([...currentLog]);
  }
}

function checkAnswer() {
  const input = document.getElementById("answerInput").value.trim().toLowerCase();
  const q = shuffled[currentIndex];
  const correct = q.word;
  let feedback = "";
  if (input === correct) {
    feedback = "âœ… æ­£ç¢ºï¼";
    score++;
    currentLog.push(`[${currentIndex + 1}] ${q.hint} â†’ ${generatePuzzle(q.word)}\nä½ çš„ç­”æ¡ˆï¼š${input} âœ…`);
  } else {
    feedback = `âŒ éŒ¯èª¤ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${correct}`;
    currentLog.push(`[${currentIndex + 1}] ${q.hint} â†’ ${generatePuzzle(q.word)}\nä½ çš„ç­”æ¡ˆï¼š${input} âŒ æ­£ç¢ºç­”æ¡ˆï¼š${correct}`);
  }
  document.getElementById("feedback").innerText = feedback;
  currentIndex++;
  setTimeout(displayQuestion, 500);
}

function restart() {
  currentIndex = 0;
  score = 0;
  shuffled = [...questions].sort(() => Math.random() - 0.5);
  currentLog = [`=== æ¸¬é©—æ™‚é–“ï¼š${new Date().toLocaleString()} ===`];
  displayQuestion();
}

function toggleLog(type) {
  const logDiv = document.getElementById("logDisplay");
  if (logDiv.style.display === "none") {
    let log = "";
    if (type === "last") {
      log = allLogs.length > 0 ? allLogs[allLogs.length - 1].join("\n") : "å°šç„¡æœ€è¿‘ç´€éŒ„";
    } else if (type === "all") {
      log = allLogs.map(log => log.join("\n")).join("\n\n") || "å°šç„¡ç´€éŒ„";
    }
    logDiv.innerText = log;
    logDiv.style.display = "block";
  } else {
    logDiv.style.display = "none";
  }
}

restart();
</script>

</body>
</html>

